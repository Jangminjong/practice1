<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="WriterGoodsDAO">
	<resultMap type="goods" id="goodsResult">
	    <result property="goods_seq" column="goods_seq"/>
	 	<result property="goods_code" column="goods_code" />
		<result property="goods_name" column="goods_name"/>
		<result property="goods_price" column="goods_price" />
		<result property="goods_category" column="goods_category" />
		<result property="goods_photo" column="goods_photo" />
		<result property="goods_stock" column="goods_stock"/>
		<result property="goods_volume" column="goods_volume"/>
		<result property="goods_income" column="goods_income"/>
		<result property="goods_grade" column="goods_grade"/>
		<result property="goods_info" column="goods_info"/>
		<result property="goods_select" column="goods_select"/>
		<result property="goods_view" column="goods_view"/>
		<result property="goods_op1_code" column="goods_op1_code"/>
		<result property="goods_op2_code" column="goods_op2_code"/>
		<result property="goods_op3_code" column="goods_op3_code"/>
		<result property="goods_apply_date" column="goods_apply_date"/>
		<result property="goods_status" column="goods_status"/>
	</resultMap>

	<!-- 작품 등록 -->
	<insert id="productCreate" parameterType="goods">
		INSERT INTO goods
		(goods_seq, 
		goods_name, 
		goods_price, 
		goods_info, 
		goods_photo, 
		goods_code,
		 
		goods_category,
		goods_op1_code,
		goods_op2_code, 
		goods_op3_code)
		VALUES(nextval
		('seq_goods'), 		
		#{goods_name}, 
		#{goods_price}, 
		#{goods_info}, 
		#{goods_photo}, 
		#{goods_code},
		
		#{goods_category},
		#{goods_op1_code},
		#{goods_op2_code},
		#{goods_op3_code})
	</insert>

	<!-- 작품 수정 -->
	<update id="updateGoods" parameterType="com.idwith.mpweb.writer.goods.GoodsVO">
	 	<![CDATA[	
	 		UPDATE goods
	 		SET goods_name=#{goods_name}, 
	 		goods_price=#{goods_price}, 
	 		goods_info=#{goods_info}, 
	 		goods_photo=#{goods_photo}
	 		goods_op1_code=#{goods_op1_code},
	 		goods_op1_code=#{goods_op2_code},
	 		goods_op1_code=#{goods_op3_code}
	 	
	 		WHERE goods_seq = #{goods_seq}
	    ]]> 	
 	</update>
 	
	<!-- 작품  삭제 -->
	<delete id="deleteGoods" parameterType="goods">
		DELETE FROM goods WHERE goods_seq=#{goods_seq}
	</delete>
	
	<!-- 작품  상세조회 -->
	<select id="productModify" resultType="goods" resultMap="goodsResult">
		SELECT * FROM goods WHERE goods_seq=#{goods_seq}
	</select>

	<!-- 페이징 처리 후 작품 조회 -->
	<select id="getGoodsList" parameterType="com.idwith.mpweb.common.PagingVO" resultMap="goodsResult">
		<![CDATA[
			SELECT * FROM (
				SELECT ROW_NUMBER() OVER() as rownum, A.* FROM (SELECT *
			FROM goods ORDER BY goods_seq DESC)A)AS foo WHERE rownum BETWEEN #{start} AND #{end}
		]]>
	</select>	

     <!-- 작품 개수 출력 -->
	<select id="countGoods" resultType="int">
		select count(*) from goods
	</select>
	

</mapper>