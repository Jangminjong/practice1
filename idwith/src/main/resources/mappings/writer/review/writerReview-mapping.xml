<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ReviewDAO">
	<resultMap type="writerReview" id="writerReviewResult">
	    <result property="goods_review_seq" column="goods_review_seq"/>
	    <result property="goods_review_title" column="goods_review_title"/>
	 	<result property="goods_review_id" column="goods_review_id" />
		<result property="goods_review_code" column="goods_review_code"/>
		<result property="goods_review_date" column="goods_review_date" />
		<result property="goods_review_point" column="goods_review_point" />
		<result property="goods_review_image" column="goods_review_image" />
		<result property="goods_review_option1" column="goods_review_option1"/>
		<result property="goods_review_option2" column="goods_review_option2"/>
		<result property="goods_review_option3" column="goods_review_option3"/>
		<result property="goods_review_context" column="goods_review_context"/>
		<result property="goods_review_comment" column="goods_review_comment"/>
		<result property="goods_review_product" column="goods_review_product"/>
	</resultMap>

	<!-- 작가이야기 글 등록 -->
	<!--  <insert id="writerInsertStory" parameterType="storyBoard">
		INSERT INTO story(story_tseq, seller_id, story_title, story_date, story_context, seller_name, story_cnt)
		VALUES(nextval('story_tseq'), #{storySellerId}, #{storyBoardTitle}, now(), #{storyBoardContext}, #{storySellerName}, 0)
	</insert>
    -->
    
	<!-- 작가이야기  수정 -->
	<update id="updateReview" parameterType="com.idwith.mpweb.writer.review.ReviewVO">
	 	<![CDATA[	
	 		UPDATE goods_review
	 		SET 
	 		goods_review_product=#{goods_review_product}, 
	 		goods_review_point=#{goods_review_point},
	 		goods_review_date=#{goods_review_date},
	 		WHERE goods_review_seq = #{goods_review_seq}
	    ]]> 	
 	</update>
 	
	<!-- 작가이야기  삭제 -->
	<!--  <delete id="deleteStoryBoard" parameterType="storyBoard">
		DELETE FROM story WHERE STORY_TSEQ=#{story_tseq}
	</delete>
	-->
	
	<!-- 작가이야기  상세조회 -->
	<select id="reviewContent" resultType="writerReview" resultMap="writerReviewResult">
		SELECT * FROM goods_review WHERE goods_review_seq=#{goods_review_seq}
	</select>

	<!-- 페이징 처리 후 게시글 조회 -->
	<select id="getReviewList" parameterType="com.idwith.mpweb.common.PagingVO" resultMap="writerReviewResult">
		<![CDATA[
			SELECT * FROM (
				SELECT ROW_NUMBER() OVER() as rownum, A.* FROM (SELECT *
			FROM goods_review ORDER BY goods_review_seq DESC)A)AS foo WHERE rownum BETWEEN #{start} AND #{end}
		]]>
	</select>	

     <!-- 게시글 개수 출력 -->
	<select id="countReview" resultType="int">
		select count(*) from goods_review
	</select>
	

</mapper>