<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="ChoiceDAO">
 	<resultMap type="choiceVO" id="choiceResult">
 		<result property="choice_seq" column="choice_seq"/>
 		<result property="choice_id" column="choice_id"/>
 		<result property="choiced_code" column="choiced_code"/>
 		<result property="choice_date" column="choice_date"/>
 		<result property="choice_true" column="choice_true"/>
 	</resultMap>
 	
 	<resultMap type="followVO" id="followResult">
 		<result property="follow_seq" column="follow_seq"/>
 		<result property="follow_id" column="follow_id"/>
 		<result property="followed_id" column="followed_id"/>
 		<result property="follow_date" column="follow_date"/>
 	</resultMap>
 	
 	<!-- 상품 좋아요 추가 -->
 	<insert id="addChoice" parameterType="choiceVO">
 		INSERT INTO choice (choice_id, choiced_code, choice_date, choice_true)
 		VALUES(#{choice_id}, #{choiced_code}, now(), true)
 	</insert>
 	<!-- 찜 목록 조회 -->
 	<select id="setChoice" resultType="choiceVO">
 		SELECT * FROM choice WHERE choice_id=#{choice_id} AND choice_true=true
 	</select>
 	<!-- 기존 찜 기록이 있는지 확인 -->
 	<select id="selectChoice" resultType="_int" parameterType="choiceVO">
 		SELECT count(*) FROM choice WHERE choiced_code=#{choiced_code} AND choice_id = #{choice_id}
 	</select>
 	<!-- 찜 취소 -->
 	<update id="cancelChoice" parameterType="choiceVO">
 		UPDATE choice
 		SET choice_true=false WHERE choiced_code=#{choiced_code} AND choice_id = #{choice_id}
 	</update>
 	<update id="updateChoice" parameterType="choiceVO">
 		UPDATE choice
 		SET choice_true=true WHERE choiced_code=#{choiced_code} AND choice_id = #{choice_id}
 	</update>
 	
 	<!-- 팔로우 -->
 	<!-- 팔로우 추가 -->
 	<insert id="addFollow" parameterType="followVO">
 		INSERT INTO follow (follow_id, followed_id, follow_date)
 		VALUES(#{follow_id}, #{followed_id}, now())
 	</insert>
 	<!-- 팔로우 목록 조회 -->
 	<select id="setFollow" resultType="followVO">
 		SELECT * FROM follow WHERE follow_id=#{follow_id}
 	</select>
 	<!-- 기존 팔로우 기록이 있는지 확인 -->
 	<select id="selectFollow" resultType="_int" parameterType="choiceVO">
 		SELECT count(*) FROM follow WHERE followed_id=#{followed_id} AND follow_id = #{follow_id}
 	</select>
 	<!-- 팔로우 취소 -->
 	<delete id="deleteFollow" parameterType="followVO">
 		DELETE FROM follow WHERE followed_id=#{followed_id} AND follow_id=#{follow_id}
 	</delete>
</mapper>