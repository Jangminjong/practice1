<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="SellerCheckDAO">
 	<resultMap type="userSellerVO" id="sellerCheckResult">
 		<result property="seller_code" column="seller_code"/>
 		<result property="seller_name" column="seller_name"/>
 		<result property="seller_sellno" column="seller_sellno"/>
 		<result property="seller_sellno_img" column="seller_sellno_img" typeHandler="org.apache.ibatis.type.ArrayTypeHandler"/>
 		<result property="user_id" column="user_id"/>
 		<result property="seller_profile" column="seller_profile"/>
 		<result property="seller_profile_img" column="seller_profile_img" typeHandler="org.apache.ibatis.type.ArrayTypeHandler"/>
 		<result property="seller_done" column="seller_done"/>
 		<result property="seller_goods_yn" column="seller_goods_yn"/>
 		<result property="seller_class_yn" column="seller_class_yn"/>
 		<result property="seller_status" column="seller_status"/>
 	</resultMap>
 	
 	<resultMap type="sellerClassVO" id="sellerClassResult">
 		<result property="class_reg_seq" column="class_reg_seq" />
 		<result property="class_code" column="class_code" />
 		<result property="class_name" column="class_name" />
 		<result property="class_seller" column="class_seller" />
 		<result property="class_category_code" column="class_category_code" />
 		<result property="class_price" column="class_price" />
 		<result property="class_post_address" column="class_post_address" />
 		<result property="class_detail_address" column="class_detail_address" />
 		<result property="class_reference" column="class_reference" />
 		<result property="class_difficult" column="class_difficult" />
 		<result property="class_person" column="class_person" />
 		<result property="class_date" column="class_date" />
 		<result property="class_info" column="class_info" />
 		<result property="class_photo" column="class_photo" typeHandler="org.apache.ibatis.type.ArrayTypeHandler"/>
 		<result property="class_check" column="class_check" />
 	</resultMap>
 	
 	<resultMap type="sellerStoryVO" id="sellerStoryResult">
 		<result property="story_tseq" column="story_tseq" />
 		<result property="seller_id" column="seller_id" />
 		<result property="story_date" column="story_date" />
 		<result property="story_title" column="story_title" />
 		<result property="story_context" column="story_context" />
 		<result property="story_image" column="story_image" typeHandler="org.apache.ibatis.type.ArrayTypeHandler"/>
 		<result property="seller_name" column="seller_name" />
 		<result property="story_cnt" column="story_cnt" />
 	</resultMap>
 	
 	<resultMap type="sellerProductReviewVO" id="sellerProductReviewListResult">
 		<result property="goods_review_seq" column="goods_review_seq" />
 		<result property="goods_review_id" column="goods_review_id" />
 		<result property="goods_review_code" column="goods_review_code" />
 		<result property="goods_review_date" column="goods_review_date" />
 		<result property="goods_review_point" column="goods_review_point" />
 		<result property="goods_review_image" column="goods_review_image" typeHandler="org.apache.ibatis.type.ArrayTypeHandler"/>
 		<result property="goods_review_option1" column="goods_review_option1" />
 		<result property="goods_review_option2" column="goods_review_option2" />
 		<result property="goods_review_option3" column="goods_review_option3" />
 		<result property="goods_review_context" column="goods_review_context" />
 	</resultMap>
 	
 	<!-- 로그인 시 작가인지 판별 -->
 	<select id="sellerCheck" resultType="_long">
 		select seller_code from seller where user_id=#{user_id}
 	</select>
 	
 	<!-- 인기작가 리스트 수 -->
 	<select id="countSeller" resultType="_int">
 		select count(*) from seller <!-- 팔로워 순으로 가져오기 추가 -->
 	</select>
 	
 	<!-- 인기작가 페이징 -->
 	<select id="getSellerList" resultMap="sellerCheckResult" parameterType="userSellerVO">
 			SELECT * FROM (SELECT ROW_NUMBER() OVER() as rownum, A.* FROM (select * from seller)A)AS foo WHERE rownum BETWEEN #{start} AND #{end}
 	</select>
 	
 	<!-- 작가 정보 가져오기 -->
 	<select id="getSellerInfo" resultType="userSellerVO" resultMap="sellerCheckResult">
 		select * from seller where seller_code=${seller_code}
 	</select>
 	
 	<!-- 작가가 등록한 클래스리스트 가져오기 -->
 	<select id="getClassList" resultType="sellerClassVO" resultMap="sellerClassResult">
 		<!--  select * from class_reg where class_seller=#{class_seller} -->
 		select s.seller_name from class_reg as cr
			join seller as s
			on cr.class_seller = s.seller_code
		where s.seller_code=#{seller_code}
 	</select>
 	
 	<!-- 작가가 작성한 스토리 가져오기 -->
 	<select id="getSellerStory" resultType="sellerStoryVO" resultMap="sellerStoryResult">
 		select * from story where seller_id=#{seller_id}
 	</select>
 	
 	<!-- 작가의 등록한 상품에 대한 리뷰 -->
 	<select id="getSellerProductReviewList" resultType="sellerProductReviewVO" resultMap="sellerProductReviewListResult">
 		select * from goods_review where goods_review_code = (select goods_code from goods where seller_code=#{seller_code})
 	</select>
 	
 	<!-- 작가의 등록한 상품에 대한 리뷰 -->
 	<select id="countSellerGoods" resultType="_int">
 		select count(*) from goods where seller_code=#{seller_code}
 	</select>
 	
 	<!-- 작가의 등록한 상품에 대한 리뷰 -->
 	<select id="getSellerStoryList" resultMap="sellerStoryResult" parameterType="sellerStoryVO">
 			SELECT * FROM (SELECT ROW_NUMBER() OVER() as rownum, A.* FROM (select * from story where seller_id=#{countNotice})A)AS foo WHERE rownum BETWEEN #{start} AND #{end}
 	</select>
 	
</mapper>